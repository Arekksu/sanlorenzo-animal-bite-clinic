<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Login - San Lorenzo Vaccination & Animal Bite Clinic</title>

    <!-- Correct Flask way to load CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='employee-login-styles.css') }}">
</head>
<body>
    <div class="login-container">
        <div class="login-card">
            <div class="clinic-header">
                <!-- Load image correctly from static/images -->
                <img src="{{ url_for('static', filename='images/san lorenzo.jpg') }}" 
                     alt="San Lorenzo Clinic Logo" class="clinic-logo">
                <h1>San Lorenzo Vaccination & Animal Bite Clinic</h1>
                <p class="clinic-subtitle">Employee Login Portal</p>
            </div>
            
                     <form class="login-form" method="POST" action="{{ url_for('employee_login') }}">
                
                                <!-- notifications are shown as top-right toasts -->

                <div class="form-group">
                    <label for="employeeId">Employee ID:</label>
                    <input type="text" id="employeeId" name="employeeId" placeholder="Enter your employee ID" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password" placeholder="Enter your password" required>
                </div>
                
                <button type="submit" class="login-btn">
                    <span class="btn-text">Login</span>
                </button>
                
                <div class="login-footer">
                    <p class="demo-info">Demo Credentials:</p>
                    <p class="demo-credentials">admin/admin123 | doctor1/doc123 | nurse1/nurse123 | staff1/staff123</p>
                </div>
            </form>
            
            <div class="system-info">
                <p>LAN-Based Employee System</p>
                <p id="currentDateTime"></p>
            </div>
        </div>
    </div>

        <!-- External script (if present) -->
        <script src="{{ url_for('static', filename='employee-login-script.js') }}"></script>

        <!-- Toast container and script -->
        <div id="toast-container" aria-live="polite" aria-atomic="true"></div>
        <script>
            // Create and show a top-right toast. Auto-dismiss after timeout.
            function showToast(type, message, timeoutMs) {
                timeoutMs = timeoutMs || 2500;
                var container = document.getElementById('toast-container');
                if (!container) return;
                var toast = document.createElement('div');
                toast.className = 'toast ' + (type === 'success' ? 'toast-success' : 'toast-error');
                toast.textContent = message;
                container.appendChild(toast);
                // show animation
                requestAnimationFrame(function(){ toast.classList.add('visible'); });
                // remove after timeout
                setTimeout(function(){
                    toast.classList.remove('visible');
                    setTimeout(function(){ if (toast.parentNode) toast.parentNode.removeChild(toast); }, 300);
                }, timeoutMs);
            }

            window.addEventListener('DOMContentLoaded', function () {
                // Read server-provided login status from JSON blob
                var serverDataEl = document.getElementById('login-server-data');
                var server = { error: null, success: false, redirect_url: '' };
                if (serverDataEl && serverDataEl.textContent) {
                    try { server = JSON.parse(serverDataEl.textContent); } catch(e){ console.warn('Invalid server login data', e); }
                }
                if (server.error) {
                    // show error toast (no redirect)
                    showToast('error', server.error, 3500);
                }
                if (server.success) {
                    // show a clean success toast (no "Go to Dashboard" button)
                    showToast('success', 'Login successful â€” redirecting...', 1600);
                    setTimeout(function(){ window.location = server.redirect_url; }, 1400);
                }

                // current date/time
                var dtEl = document.getElementById('currentDateTime');
                if (dtEl) dtEl.textContent = new Date().toLocaleString();
            });
        </script>
        <style>
            /* Toast container (top-right) */
            #toast-container{ position:fixed; top:16px; right:16px; z-index:9999; display:flex; flex-direction:column; gap:8px; }
            .toast{ min-width:220px; max-width:360px; padding:10px 14px; border-radius:8px; color:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.12); opacity:0; transform:translateY(-8px) scale(0.98); transition:all .28s ease; }
            .toast.visible{ opacity:1; transform:translateY(0) scale(1); }
            .toast-success{ background:linear-gradient(180deg,#2dbb74,#1fa45a); }
            .toast-error{ background:linear-gradient(180deg,#f36b6b,#d64545); }
        </style>
        <!-- Server-provided login result (keeps JS syntax clean) -->
        <script id="login-server-data" type="application/json">{{ {'error': error|default(None), 'success': success|default(False), 'redirect_url': redirect_url|default('') } | tojson | safe }}</script>
</body>
</html>
